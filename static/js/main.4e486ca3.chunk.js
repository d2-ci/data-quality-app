(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{117:function(e,t,a){e.exports={gridElement:"GridSection_gridElement__3DOqL",gridTitleBar:"GridSection_gridTitleBar__2-OEV",gridTitleDescription:"GridSection_gridTitleDescription__1jy96",gridIcon:"GridSection_gridIcon__1INTx",gridDescription:"GridSection_gridDescription__1NNso",gridActionText:"GridSection_gridActionText__1S-Gc"}},14:function(e,t,a){e.exports={section:"Page_section__48ljQ",mainButton:"Page_mainButton__38d7P",appTable:"Page_appTable__3ksZt",right:"Page_right__oLgt0",center:"Page_center__120Pl",centerFlex:"Page_centerFlex__3KXC0",pageHeader:"Page_pageHeader__1NFoO",cardHeader:"Page_cardHeader__xj55q",cardFooter:"Page_cardFooter__RiSMS",spaceBetween:"Page_spaceBetween__2b-hs",end:"Page_end__3xjyQ",formLabel:"Page_formLabel__22ela",checkboxWrapper:"Page_checkboxWrapper__1ypbH"}},1543:function(e,t,a){},1552:function(e,t,a){"use strict";a.r(t);var n=a(347),i=a.n(n),s=a(650),o=a(0),l=a.n(o),r=a(28),c=a.n(r),d=a(116),u=a(114),m=a(348),p=a(24),h=a.n(p),g=a(10),b=a.n(g),f=a(651),v=a.n(f),E=function(e){var t=e.keyUiLocale;(function(e){var t=["ar","fa","ur"],a=t.map(function(e){return"".concat(e,"-")});return t.includes(e)||a.filter(function(t){return e.startsWith(t)}).length>0})(t)&&document.body.setAttribute("dir","rtl"),b.a.changeLanguage(t),v.a.locale(t)},y=function(e){if(e){var t={settings:"Settings",app_search_placeholder:"Search apps",profile:"Profile",account:"Account",help:"Help",log_out:"Log out",about_dhis2:"About DHIS 2",manage_my_apps:"Manage my apps",no_results_found:"No results found",interpretations:"Interpretations",messages:"Messages"};Object.keys(t).forEach(function(e){t[e]=b.a.t(t[e])}),Object.assign(e.i18n.translations,t)}},k=(a(757),a(77)),O=a(29),S=a(27),C=a(31),D=a(30),w=a(21),x=a(32),A=(a(758),a(759),a(1)),I=a.n(A),T=a(715),N=a(704),j=a(705),_=a(718),R=(a(1543),a(13)),U=a.n(R),P=a(214),F=a(41),V=a.n(F),M=a(117),L=a.n(M),B=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return l.a.createElement(u.b,{className:"link",to:this.props.section.path},l.a.createElement(P.GridTile,{key:this.props.section.key,className:U()("section",L.a.gridElement)},l.a.createElement("div",{className:U()("row",L.a.gridTitleBar)},l.a.createElement("span",{className:U()("section-title",L.a.gridTitleDescription)},this.props.section.info.label()),l.a.createElement(V.a,{className:U()("material-icons","icon",L.a.gridIcon)},this.props.section.info.icon)),l.a.createElement("span",{className:U()("section-description","row",L.a.gridDescription)},this.props.section.info.description()),l.a.createElement("span",{className:U()("section-action-text","row",L.a.gridActionText)},this.props.section.info.actionText())))}}]),t}(o.PureComponent),G=a(708),W=a.n(G),K=a(48),H=a(67),q=a.n(H),z=a(55),X=a.n(z),J=a(76),Q=a.n(J),Y=a(11),Z=a(39),$=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillMount",value:function(){this.pageMounted=!0,this.context.currentSection!==this.props.sectionKey&&this.context.updateAppState({currentSection:this.props.sectionKey})}},{key:"componentWillUnmount",value:function(){this.pageMounted=!1}},{key:"isPageMounted",value:function(){return this.pageMounted}},{key:"manageError",value:function(e){if(this.isPageMounted()){var t=e&&e.message?e.message:b.a.t("An unexpected error happened during analysis");this.context.updateAppState({showSnackbar:!0,snackbarConf:{type:Z.b,message:t},pageState:{loading:!1}})}}}]),t}(o.Component);$.contextTypes={d2:I.a.object,currentSection:I.a.string,updateAppState:I.a.func};var ee=$,te=a(709),ae=a.n(te),ne=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return l.a.createElement(Y.h,null,l.a.createElement("div",{className:ae.a.alertBar,style:{display:this.props.show?"flex":"none"}},b.a.t("More than 500 values found, please narrow the search to see all")))}}]),t}(o.PureComponent),ie=a(716),se=a(68),oe=a.n(se),le=a(37),re=a.n(le),ce=-1,de={id:ce,displayName:"[All Validation Rules]"},ue=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={validationRuleGroups:[de],selected:ce},e.onChange=e.onChange.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.context.d2,a=de;a.displayName=b.a.t(de.displayName),t.models.validationRuleGroup.list({paging:!1,fields:"id,displayName"}).then(function(t){e.setState({validationRuleGroups:[a].concat(Object(ie.a)(t.toArray()))})}).catch(function(){e.manageError()})}},{key:"onChange",value:function(e,t,a){this.setState({selected:a,selectedName:a===ce?"[All Validation Rules]":this.state.validationRuleGroups[t].displayName}),this.props.onChange(e,t,a)}},{key:"render",value:function(){return l.a.createElement(oe.a,{style:this.props.style,floatingLabelText:b.a.t("Validation Rule Group"),onChange:this.onChange,value:this.state.selected},this.state.validationRuleGroups.map(function(e){return l.a.createElement(re.a,{key:e.id,value:e.id,primaryText:e.displayName})}))}}]),t}(o.PureComponent);ue.defaultProps={style:{}},ue.contextTypes={d2:I.a.object};var me=ue,pe=a(719),he=a(710),ge=a.n(he),be=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={selected:[],rootWithMember:null},e.handleOrgUnitClick=e.handleOrgUnitClick.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.context.d2;null==this.state.rootWithMember&&t.models.organisationUnits.list({paging:!1,level:1,fields:"id,displayName,path,children::isNotEmpty,memberCount"}).then(function(t){var a=t.toArray();e.setState({rootWithMembers:a[0]})}).catch(function(){e.manageError()})}},{key:"handleOrgUnitClick",value:function(e,t){if(!this.state.selected.includes(t.path)&&(this.setState({selected:[t.path]}),this.props.onChange)){var a=t.path.split("/"),n=a[a.length-1];this.props.onChange(n)}}},{key:"render",value:function(){return this.state.rootWithMembers?l.a.createElement("div",{className:ge.a.tree},l.a.createElement(pe.a,{hideMemberCount:Boolean(!0),root:this.state.rootWithMembers,selected:this.state.selected,initiallyExpanded:["/".concat(this.state.rootWithMembers.id)],onSelectClick:this.handleOrgUnitClick})):l.a.createElement("span",null,b.a.t("Updating Organisation Units Tree..."))}}]),t}(o.PureComponent);be.contextTypes={d2:I.a.object},be.defaultProps={onChange:null};var fe=be,ve=function(e){var t=e.major,a=e.minor;return e.snapshot?"master":"".concat(t,".").concat(a)},Ee=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.context.d2,t=this.props,a=t.lng,n=t.sectionDocsKey;return l.a.createElement(Y.g,{className:"helper-icon",iconStyle:{color:"#276696"},href:"".concat("https://ci.dhis2.org/docs","/").concat(ve(e.system.version),"/").concat(a,"/user/html/").concat(n,".html"),target:"_blank",rel:"noopener noreferrer",tooltip:b.a.t("Open user guide"),tooltipPosition:"bottom-center",iconClassName:"material-icons"},"help")}}]),t}(o.PureComponent);Ee.defaultProps={lng:"en"},Ee.contextTypes={d2:I.a.object};var ye=Ee,ke={inputForm:{width:"100%"},iconColor:{fill:"#ff9900"},cursorStyle:{cursor:"pointer"}},Oe=a(14),Se=a.n(Oe),Ce=function(e){return l.a.createElement("span",null,new Intl.NumberFormat(sessionStorage.getItem("uiLocale"),{minimumFractionDigits:2,maximumFractionDigits:2}).format(e.value))},De=a(711),we=a.n(De),xe=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.context.d2.Api.getApi(),t=Date.now();return l.a.createElement("div",{className:we.a.downloadAs},l.a.createElement("a",{className:"export-pdf-action",href:"".concat(e.baseUrl).concat(this.props.endpoint,".pdf?t=").concat(t),download:!0},b.a.t("DOWNLOAD AS PDF")),l.a.createElement("a",{className:"export-xls-action",href:"".concat(e.baseUrl).concat(this.props.endpoint,".xls?t=").concat(t),download:!0},b.a.t("DOWNLOAD AS XLS")),l.a.createElement("a",{className:"export-csv-action",href:"".concat(e.baseUrl).concat(this.props.endpoint,".csv?t=").concat(t),download:!0},b.a.t("DOWNLOAD AS CSV")))}}]),t}(o.PureComponent);xe.contextTypes={d2:I.a.object};var Ae=xe,Ie=a(355),Te=a.n(Ie),Ne=a(717),je=a(81),_e=a.n(je),Re={endpoints:{validationRulesAnalysis:"/dataAnalysis/validationRules",validationRulesExpression:"/dataAnalysis/validationRulesExpression",validationRulesReport:"/dataAnalysis/validationRules/report",validationRules:"/validationRules",minMaxOutliersAnalysis:"/dataAnalysis/minMaxOutlier",standardDeviationOutliersAnalysis:"/dataAnalysis/stdDevOutlier",folloupAnalysis:"/dataAnalysis/followup",markDataValue:"/dataAnalysis/followup/mark",reportAnalysis:"/dataAnalysis/report"},results:{analysis:{limit:500}}},Ue=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={loading:!1,openDetails:!1,rule:{},expression:{leftSide:[],rightSide:[]}},e.loadDetails=e.loadDetails.bind(Object(w.a)(e)),e.handleClose=e.handleClose.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t={};Object.keys(e).forEach(function(a){e.hasOwnProperty(a)&&Le.STATE_PROPERTIES.includes(a)&&(t[a]=e[a])}),t!=={}&&this.setState(t)}},{key:"loadDetails",value:function(){var e=this;if(!this.state.loading){var t=this.context.d2.Api.getApi(),a="".concat(Re.endpoints.validationRules,"/").concat(this.props.validationRuleId),n="".concat(Re.endpoints.validationRulesExpression)+"?validationRuleId=".concat(this.props.validationRuleId)+"&periodId=".concat(this.props.periodId)+"&organisationUnitId=".concat(this.props.organisationUnitId);this.context.updateAppState({pageState:{loading:!0}}),Promise.all([t.get(a),t.get(n)]).then(function(t){var a=Object(Ne.a)(t,2),n=a[0],i=a[1];e.context.updateAppState({pageState:{loading:!1}}),e.setState({openDetails:!0,rule:n,expression:i})}).catch(function(){e.manageError()})}}},{key:"handleClose",value:function(){this.setState({openDetails:!1})}},{key:"render",value:function(){var e=[l.a.createElement(Y.e,{className:"close-action",key:"FB".concat(this.props.organisationUnitId,"-").concat(this.props.periodId,"-").concat(this.props.validationRuleId),label:b.a.t("Close"),primary:Boolean(!0),onClick:this.handleClose})],t=l.a.createElement("div",{className:U()("row","results-row",_e.a.sectionBox)},l.a.createElement("div",{className:U()("col-xs-12",_e.a.sectionTitle)},b.a.t("VALIDATIONS RESULT DETAILS")),l.a.createElement("div",{className:U()("col-xs-12",_e.a.sectionSubTitle)},b.a.t("VALIDATION RULE")),l.a.createElement("div",{className:"col-xs-3"},b.a.t("Name")),l.a.createElement("div",{className:"col-xs-9"},this.state.rule.displayName),l.a.createElement("div",{className:"col-xs-3"},b.a.t("Description")),l.a.createElement("div",{className:"col-xs-9"},this.state.rule.displayDescription)),a=function(e){return l.a.createElement("div",{className:U()("row",_e.a.sectionBox)},l.a.createElement("div",{className:U()("col-xs-12",_e.a.sectionTitle)},e),l.a.createElement("div",{className:U()("col-xs-12",Se.a.center)},l.a.createElement("div",{className:_e.a.noData},b.a.t("no data available"))))},n=function(e,t,a){return l.a.createElement("div",{className:U()("row",a,_e.a.sectionBox)},l.a.createElement("div",{className:U()("col-xs-12",_e.a.sectionTitle)},e),l.a.createElement("div",{className:U()("col-xs-10",_e.a.sectionSubTitle)},b.a.t("DATA ELEMENT")),l.a.createElement("div",{className:U()("col-xs-2",_e.a.sectionSubTitle,Se.a.right)},b.a.t("VALUE")),t.map(function(e){return l.a.createElement("div",{key:e.name,className:"col-xs-12"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-xs-10"},e.name),l.a.createElement("div",{className:U()("col-xs-2",Se.a.right)},e.value?l.a.createElement(Ce,{value:Number(e.value)}):"-")))}))};return l.a.createElement("div",null,l.a.createElement(Y.f,{key:"FI|".concat(this.props.organisationUnitId,"-").concat(this.props.periodId,"-").concat(this.props.validationRuleId),className:"validation-rules-show-details-action material-icons",style:ke.cursorStyle,onClick:this.loadDetails},"info"),l.a.createElement(Y.d,{className:"validation-rules-details-dialog",key:"D".concat(this.props.organisationUnitId,"-").concat(this.props.periodId,"-").concat(this.props.validationRuleId),autoScrollBodyContent:Boolean(!0),title:b.a.t("Validation Details"),actions:e,modal:Boolean(!0),open:this.state.openDetails,onRequestClose:this.handleClose},t,this.state.expression.leftSide&&this.state.expression.leftSide.length>0?n(b.a.t("LEFT SIDE"),this.state.expression.leftSide,"left-side-row"):a(b.a.t("LEFT SIDE")),this.state.expression.rightSide&&this.state.expression.rightSide.length>0?n(b.a.t("RIGHT SIDE"),this.state.expression.rightSide,"right-side-row"):a(b.a.t("RIGHT SIDE"))))}}]),t}(ee);Ue.STATE_PROPERTIES=["loading"],Ue.propTypes={validationRuleId:I.a.string.isRequired,periodId:I.a.string.isRequired,organisationUnitId:I.a.string.isRequired};var Pe=Ue,Fe=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.elements.map(function(e){return l.a.createElement(Y.o,{key:e.key},l.a.createElement(Y.p,null,e.organisation),l.a.createElement(Y.p,null,e.period),l.a.createElement(Y.p,null,e.importance),l.a.createElement(Y.p,null,e.validationRule),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:e.leftValue})),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement("span",{className:Te.a.operator},e.operator)),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:e.rightValue})),l.a.createElement(Y.p,{className:Se.a.center},l.a.createElement(Pe,{validationRuleId:e.validationRuleId,periodId:e.periodId,organisationUnitId:e.organisationUnitId})))});return l.a.createElement("div",null,l.a.createElement("div",{className:Se.a.cardHeader},l.a.createElement(Ae,{endpoint:Re.endpoints.validationRulesReport})),l.a.createElement(Y.k,{selectable:!1,className:U()(Se.a.appTable,Te.a.validationTable)},l.a.createElement(Y.m,{displaySelectAll:!1,adjustForCheckbox:!1,enableSelectAll:!1},l.a.createElement(Y.o,null,l.a.createElement(Y.n,null,b.a.t("Organisation Unit")),l.a.createElement(Y.n,null,b.a.t("Period")),l.a.createElement(Y.n,null,b.a.t("Importance")),l.a.createElement(Y.n,null,b.a.t("Validation Rule")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Value")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Operator")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Value")),l.a.createElement(Y.n,{className:Se.a.center},b.a.t("Details")))),l.a.createElement(Y.l,{displayRowCheckbox:!1,stripedRows:!1},e)),l.a.createElement("div",{className:U()(Se.a.cardFooter,Se.a.end)},l.a.createElement(Ae,{endpoint:Re.endpoints.validationRulesReport})))}}]),t}(o.PureComponent),Ve=function(e){return e.toISOString().split("T")[0]},Me=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={showTable:!1,startDate:new Date,endDate:new Date,organisationUnitId:null,validationRuleGroupId:ce,notification:!1,persist:!1,elements:[],loading:!1},e.validate=e.validate.bind(Object(w.a)(e)),e.back=e.back.bind(Object(w.a)(e)),e.startDateOnChange=e.startDateOnChange.bind(Object(w.a)(e)),e.endDateOnChange=e.endDateOnChange.bind(Object(w.a)(e)),e.organisationUnitOnChange=e.organisationUnitOnChange.bind(Object(w.a)(e)),e.validationRuleGroupOnChange=e.validationRuleGroupOnChange.bind(Object(w.a)(e)),e.updateSendNotifications=e.updateSendNotifications.bind(Object(w.a)(e)),e.updatePersistNewResults=e.updatePersistNewResults.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillReceiveProps",value:function(e){var a={};Object.keys(e).forEach(function(n){e.hasOwnProperty(n)&&t.STATE_PROPERTIES.includes(n)&&(a[n]=e[n])}),a!=={}&&this.setState(a)}},{key:"validate",value:function(){var e=this,a=this.context.d2.Api.getApi();if(this.isFormValid()){var n={startDate:Ve(this.state.startDate),endDate:Ve(this.state.endDate),ou:this.state.organisationUnitId,notification:this.state.notification,persist:this.state.persist};this.state.validationRuleGroupId!==ce&&(n.vrg=this.state.validationRuleGroupId),this.context.updateAppState({pageState:{loading:!0}}),a.post(Re.endpoints.validationRulesAnalysis,Object(k.a)({},n)).then(function(a){if(e.isPageMounted()){var n=a.map(t.convertElementFromApiResponse),i=n&&n.length>0?{showSnackbar:!1}:{showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t("Validation passed successfully")}};e.context.updateAppState(Object(k.a)({},i,{pageState:{loading:!1,elements:n,showTable:n&&n.length>0}}))}}).catch(function(){e.manageError()})}}},{key:"back",value:function(){this.setState({showTable:!1})}},{key:"startDateOnChange",value:function(e,t){this.setState({startDate:new Date(t)})}},{key:"endDateOnChange",value:function(e,t){this.setState({endDate:new Date(t)})}},{key:"organisationUnitOnChange",value:function(e){this.setState({organisationUnitId:e})}},{key:"validationRuleGroupOnChange",value:function(e,t,a){this.setState({validationRuleGroupId:a})}},{key:"updateSendNotifications",value:function(e,t){this.setState({notification:t})}},{key:"updatePersistNewResults",value:function(e,t){this.setState({persist:t})}},{key:"showAlertBar",value:function(){return this.state.showTable&&this.state.elements&&this.state.elements.length>=Re.results.analysis.limit}},{key:"isFormValid",value:function(){return this.state.startDate&&this.state.endDate&&this.state.organisationUnitId}},{key:"isActionDisabled",value:function(){return!this.isFormValid()||this.state.loading}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h1",{className:Se.a.pageHeader},l.a.createElement(Y.g,{onClick:this.back,style:{display:this.state.showTable?"inline":"none"}},l.a.createElement(Y.f,{className:"material-icons"},"arrow_back")),b.a.t("Validation Rule Analysis"),l.a.createElement(ye,{sectionDocsKey:ot(this.props.sectionKey)})),l.a.createElement(ne,{show:this.showAlertBar()}),l.a.createElement(K.Card,null,l.a.createElement(K.CardText,{style:{display:this.state.showTable?"none":"block"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:U()("col-md-6",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Parent organisation unit")),l.a.createElement(fe,{onChange:this.organisationUnitOnChange})),l.a.createElement("div",{className:U()("col-md-6",Se.a.section)},l.a.createElement(X.a,{id:"start-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("Start Date"),onChange:this.startDateOnChange,value:this.state.startDate,defaultDate:new Date,maxDate:this.state.endDate}),l.a.createElement(X.a,{id:"end-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("End Date"),onChange:this.endDateOnChange,value:this.state.endDate,defaultDate:new Date,minDate:this.state.startDate}),l.a.createElement("div",{id:"validation-rule-groups"},l.a.createElement(me,{style:ke.inputForm,onChange:this.validationRuleGroupOnChange})),l.a.createElement("div",{id:"send-notifications-option"},l.a.createElement(Q.a,{label:b.a.t("Send Notifications"),labelPosition:"left",checked:this.state.notification,onCheck:this.updateSendNotifications})),l.a.createElement("div",{id:"persist-results-option"},l.a.createElement(Q.a,{label:b.a.t("Persist new results"),labelPosition:"left",checked:this.state.persist,onCheck:this.updatePersistNewResults})))),l.a.createElement(q.a,{id:"start-analysis-button",className:Se.a.mainButton,label:b.a.t("validate"),primary:!0,disabled:this.isActionDisabled(),onClick:this.validate})),l.a.createElement(K.CardText,{id:"results-table",style:{display:this.state.showTable?"block":"none"}},l.a.createElement(Fe,{elements:this.state.elements}))))}}]),t}(ee);Me.STATE_PROPERTIES=["loading","elements","showTable"],Me.generateElementKey=function(e){return"".concat(e.validationRuleId,"-").concat(e.periodId,"-").concat(e.organisationUnitId)},Me.convertElementFromApiResponse=function(e){return{key:Me.generateElementKey(e),validationRuleId:e.validationRuleId,organisation:e.organisationUnitDisplayName,organisationUnitId:e.organisationUnitId,period:e.periodDisplayName,periodId:e.periodId,importance:e.importance,validationRule:e.validationRuleDescription,leftValue:e.leftSideValue,operator:e.operator,rightValue:e.rightSideValue}};var Le=Me,Be=a(356),Ge=a.n(Be),We=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={dataSets:null},e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.context.d2;null==this.state.dataSets&&t.models.dataSet.list({paging:!1,fields:"id,displayName"}).then(function(t){e.setState({dataSets:t.toArray()})}).catch(function(){e.manageError()})}},{key:"render",value:function(){return l.a.createElement("select",{multiple:!0,className:Ge.a.select,onChange:this.props.onChange},(this.state.dataSets||[]).map(function(e){return l.a.createElement("option",{key:e.id,value:e.id,className:Ge.a.options},e.displayName)}))}}]),t}(o.PureComponent);We.contextTypes={d2:I.a.object},We.defaultProps={onChange:null};var Ke=We,He=a(712),qe=a.n(He),ze=function(e){var t=e.elements,a=e.toggleCheckbox,n=t.map(function(e){return l.a.createElement(Y.o,{key:e.key},l.a.createElement(Y.p,null,e.dataElement),l.a.createElement(Y.p,null,e.organisation),l.a.createElement(Y.p,null,e.period),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:e.min})),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:e.value})),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:e.max})),l.a.createElement(Y.p,{className:Se.a.centerFlex},l.a.createElement("span",{className:Se.a.checkboxWrapper},l.a.createElement(Y.a,{checked:e.marked,onCheck:function(){a(e)},iconStyle:ke.iconColor}))))});return l.a.createElement("div",null,l.a.createElement("div",{className:Se.a.cardHeader},l.a.createElement(Ae,{endpoint:Re.endpoints.reportAnalysis})),l.a.createElement(Y.k,{selectable:!1,className:U()(Se.a.appTable,qe.a.outlierAnalysisTable)},l.a.createElement(Y.m,{displaySelectAll:!1,adjustForCheckbox:!1,enableSelectAll:!1},l.a.createElement(Y.o,null,l.a.createElement(Y.n,null,b.a.t("Data Element")),l.a.createElement(Y.n,null,b.a.t("Organisation Unit")),l.a.createElement(Y.n,null,b.a.t("Period")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Min")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Value")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Max")),l.a.createElement(Y.n,{className:Se.a.center},b.a.t("Mark")))),l.a.createElement(Y.l,{displayRowCheckbox:!1,stripedRows:!1},n)),l.a.createElement("div",{className:U()(Se.a.cardFooter,Se.a.end)},l.a.createElement(Ae,{endpoint:Re.endpoints.reportAnalysis})))};ze.generateElementKey=function(e){return"".concat(e.attributeOptionComboId,"-").concat(e.categoryOptionComboId,"-").concat(e.periodId,"-").concat(e.sourceId,"-").concat(e.dataElementId)},ze.convertElementFromApiResponse=function(e){return{key:ze.generateElementKey(e),attributeOptionComboId:e.attributeOptionComboId,categoryOptionComboId:e.categoryOptionComboId,periodId:e.periodId,organisationUnitId:e.sourceId,dataElementId:e.dataElementId,dataElement:e.dataElementName,organisation:e.sourceName,period:e.period.name,min:e.min,max:e.max,value:Number.parseFloat(e.value),marked:e.followup}},ze.convertElementToToggleFollowupRequest=function(e){return{dataElementId:e.dataElementId,periodId:e.periodId,organisationUnitId:e.organisationUnitId,categoryOptionComboId:e.categoryOptionComboId,attributeOptionComboId:e.attributeOptionComboId,followup:!e.marked}},ze.contextTypes={d2:I.a.object};var Xe=ze,Je=3,Qe=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={showTable:!1,startDate:new Date,endDate:new Date,organisationUnitId:null,dataSetIds:[],elements:[],standardDeviation:Je},e.start=e.start.bind(Object(w.a)(e)),e.back=e.back.bind(Object(w.a)(e)),e.startDateOnChange=e.startDateOnChange.bind(Object(w.a)(e)),e.endDateOnChange=e.endDateOnChange.bind(Object(w.a)(e)),e.organisationUnitOnChange=e.organisationUnitOnChange.bind(Object(w.a)(e)),e.dataSetsOnChange=e.dataSetsOnChange.bind(Object(w.a)(e)),e.standardDeviationOnChange=e.standardDeviationOnChange.bind(Object(w.a)(e)),e.toggleCheckbox=e.toggleCheckbox.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillReceiveProps",value:function(e){var a={};Object.keys(e).forEach(function(n){e.hasOwnProperty(n)&&t.STATE_PROPERTIES.includes(n)&&(a[n]=e[n])}),a!=={}&&this.setState(a)}},{key:"start",value:function(){var e=this,t=this.context.d2.Api.getApi();this.isFormValid()&&(this.context.updateAppState({pageState:{loading:!0}}),t.post(Re.endpoints.standardDeviationOutliersAnalysis,{startDate:Ve(this.state.startDate),endDate:Ve(this.state.endDate),ou:this.state.organisationUnitId,ds:this.state.dataSetIds,standardDeviation:this.state.standardDeviation}).then(function(t){if(e.isPageMounted()){var a=t.map(Xe.convertElementFromApiResponse),n=a&&a.length>0?{showSnackbar:!1}:{showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t("No values found")}};e.context.updateAppState(Object(k.a)({},n,{pageState:{loading:!1,elements:a,showTable:a&&a.length>0}}))}}).catch(function(){e.manageError()}))}},{key:"back",value:function(){this.setState({showTable:!1})}},{key:"startDateOnChange",value:function(e,t){this.setState({startDate:new Date(t)})}},{key:"endDateOnChange",value:function(e,t){this.setState({endDate:new Date(t)})}},{key:"organisationUnitOnChange",value:function(e){this.setState({organisationUnitId:e})}},{key:"dataSetsOnChange",value:function(e){for(var t=[],a=e.target.selectedOptions,n=0;n<a.length;n++)t.push(a[n].value);this.setState({dataSetIds:t})}},{key:"standardDeviationOnChange",value:function(e,t,a){this.setState({standardDeviation:a})}},{key:"toggleCheckbox",value:function(e){for(var t=this,a=this.context.d2.Api.getApi(),n=this.state.elements,i=function(i){var s=n[i];if(s.key===e.key)return t.context.updateAppState({pageState:{loading:!0}}),a.post(Re.endpoints.markDataValue,{followups:[Xe.convertElementToToggleFollowupRequest(s)]}).then(function(){t.isPageMounted()&&(s.marked=!s.marked,n[i]=s,t.context.updateAppState({showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t(s.marked?"Marked":"Unmarked")},pageState:{elements:n,loading:!1}}))}).catch(function(){t.manageError()}),"break"},s=0;s<n.length;s++){if("break"===i(s))break}}},{key:"isFormValid",value:function(){return this.state.startDate&&this.state.endDate&&this.state.organisationUnitId&&this.state.standardDeviation&&this.state.dataSetIds&&this.state.dataSetIds.length>0}},{key:"isActionDisabled",value:function(){return!this.isFormValid()||this.state.loading}},{key:"showAlertBar",value:function(){return this.state.showTable&&this.state.elements&&this.state.elements.length>=Re.results.analysis.limit}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h1",{className:Se.a.pageHeader},l.a.createElement(Y.g,{onClick:this.back,style:{display:this.state.showTable?"inline":"none"}},l.a.createElement(Y.f,{className:"material-icons"},"arrow_back")),b.a.t("Std Dev Outlier Analysis"),l.a.createElement(ye,{sectionDocsKey:ot(this.props.sectionKey)})),l.a.createElement(ne,{show:this.showAlertBar()}),l.a.createElement(K.Card,null,l.a.createElement(K.CardText,{style:{display:this.state.showTable?"none":"block"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{id:"data-sets-container",className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Data Set")),l.a.createElement(Ke,{onChange:this.dataSetsOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Parent organisation unit")),l.a.createElement(fe,{onChange:this.organisationUnitOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement(X.a,{id:"start-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("Start Date"),onChange:this.startDateOnChange,defaultDate:new Date,maxDate:this.state.endDate,value:this.state.startDate}),l.a.createElement(X.a,{id:"end-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("End Date"),onChange:this.endDateOnChange,defaultDate:new Date,minDate:this.state.startDate,value:this.state.endDate}),l.a.createElement(oe.a,{id:"standard-deviation",style:ke.inputForm,floatingLabelText:b.a.t("Select number of standard deviations"),onChange:this.standardDeviationOnChange,value:this.state.standardDeviation},l.a.createElement(re.a,{value:1,primaryText:"1.0"}),l.a.createElement(re.a,{value:1.5,primaryText:"1.5"}),l.a.createElement(re.a,{value:2,primaryText:"2.0"}),l.a.createElement(re.a,{value:2.5,primaryText:"2.5"}),l.a.createElement(re.a,{value:3,primaryText:"3.0"}),l.a.createElement(re.a,{value:3.5,primaryText:"3.5"}),l.a.createElement(re.a,{value:4,primaryText:"4.0"}),l.a.createElement(re.a,{value:4.5,primaryText:"4.5"}),l.a.createElement(re.a,{value:5,primaryText:"5.0"})))),l.a.createElement(q.a,{id:"start-analysis-button",className:Se.a.mainButton,primary:!0,label:b.a.t("start"),onClick:this.start,disabled:this.isActionDisabled()})),l.a.createElement(K.CardText,{id:"results-table",style:{display:this.state.showTable?"block":"none"}},l.a.createElement(Xe,{elements:this.state.elements,toggleCheckbox:this.toggleCheckbox}))))}}]),t}(ee);Qe.STATE_PROPERTIES=["showTable","startDate","endDate","organisationUnitId","dataSetIds","elements","standardDeviation","loading"];var Ye=Qe,Ze=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={showTable:!1,startDate:new Date,endDate:new Date,organisationUnitId:null,dataSetIds:[],elements:[],loading:!1},e.start=e.start.bind(Object(w.a)(e)),e.back=e.back.bind(Object(w.a)(e)),e.startDateOnChange=e.startDateOnChange.bind(Object(w.a)(e)),e.endDateOnChange=e.endDateOnChange.bind(Object(w.a)(e)),e.organisationUnitOnChange=e.organisationUnitOnChange.bind(Object(w.a)(e)),e.dataSetsOnChange=e.dataSetsOnChange.bind(Object(w.a)(e)),e.toggleCheckbox=e.toggleCheckbox.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillReceiveProps",value:function(e){var a={};Object.keys(e).forEach(function(n){e.hasOwnProperty(n)&&t.STATE_PROPERTIES.includes(n)&&(a[n]=e[n])}),a!=={}&&this.setState(a)}},{key:"start",value:function(){var e=this,t=this.context.d2.Api.getApi();this.isFormValid()&&(this.context.updateAppState({pageState:{loading:!0}}),t.post(Re.endpoints.minMaxOutliersAnalysis,{startDate:Ve(this.state.startDate),endDate:Ve(this.state.endDate),ou:this.state.organisationUnitId,ds:this.state.dataSetIds}).then(function(t){if(e.isPageMounted()){var a=t.map(Xe.convertElementFromApiResponse),n=a&&a.length>0?{showSnackbar:!1}:{showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t("No values found")}};e.context.updateAppState(Object(k.a)({},n,{pageState:{loading:!1,elements:a,showTable:a&&a.length>0}}))}}).catch(function(){e.manageError()}))}},{key:"back",value:function(){this.setState({showTable:!1})}},{key:"startDateOnChange",value:function(e,t){this.setState({startDate:new Date(t)})}},{key:"endDateOnChange",value:function(e,t){this.setState({endDate:new Date(t)})}},{key:"organisationUnitOnChange",value:function(e){this.setState({organisationUnitId:e})}},{key:"dataSetsOnChange",value:function(e){for(var t=[],a=e.target.selectedOptions,n=0;n<a.length;n++)t.push(a[n].value);this.setState({dataSetIds:t})}},{key:"toggleCheckbox",value:function(e){for(var t=this,a=this.context.d2.Api.getApi(),n=this.state.elements,i=function(i){var s=n[i];if(s.key===e.key)return t.context.updateAppState({pageState:{loading:!0}}),a.post(Re.endpoints.markDataValue,{followups:[Xe.convertElementToToggleFollowupRequest(s)]}).then(function(){t.isPageMounted()&&(s.marked=!s.marked,n[i]=s,t.context.updateAppState({showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t(s.marked?"Marked":"Unmarked")},pageState:{elements:n,loading:!1}}))}).catch(function(){t.manageError()}),"break"},s=0;s<n.length;s++){if("break"===i(s))break}}},{key:"isFormValid",value:function(){return this.state.startDate&&this.state.endDate&&this.state.organisationUnitId&&this.state.dataSetIds&&this.state.dataSetIds.length>0}},{key:"isActionDisabled",value:function(){return!this.isFormValid()||this.state.loading}},{key:"showAlertBar",value:function(){return this.state.showTable&&this.state.elements&&this.state.elements.length>=Re.results.analysis.limit}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h1",{className:Se.a.pageHeader},l.a.createElement(Y.g,{onClick:this.back,style:{display:this.state.showTable?"inline":"none"}},l.a.createElement(Y.f,{className:"material-icons"},"arrow_back")),b.a.t("Min-Max Outlier Analysis"),l.a.createElement(ye,{sectionDocsKey:ot(this.props.sectionKey)})),l.a.createElement(ne,{show:this.showAlertBar()}),l.a.createElement(K.Card,null,l.a.createElement(K.CardText,{style:{display:this.state.showTable?"none":"block"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{id:"data-sets-container",className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Data Set")),l.a.createElement(Ke,{onChange:this.dataSetsOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Parent organisation unit")),l.a.createElement(fe,{onChange:this.organisationUnitOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement(X.a,{id:"start-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("Start Date"),onChange:this.startDateOnChange,defaultDate:new Date,maxDate:this.state.endDate,value:this.state.startDate}),l.a.createElement(X.a,{id:"end-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("End Date"),onChange:this.endDateOnChange,defaultDate:new Date,minDate:this.state.startDate,value:this.state.endDate}))),l.a.createElement(q.a,{id:"start-analysis-button",className:Se.a.mainButton,primary:!0,label:b.a.t("start"),onClick:this.start,disabled:this.isActionDisabled()})),l.a.createElement(K.CardText,{id:"results-table",style:{display:this.state.showTable?"block":"none"}},l.a.createElement(Xe,{elements:this.state.elements,toggleCheckbox:this.toggleCheckbox}))))}}]),t}(ee);Ze.STATE_PROPERTIES=["showTable","startDate","endDate","organisationUnitId","dataSetIds","elements","loading"];var $e=Ze,et=a(713),tt=a.n(et),at=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={showComment:!1,comment:null},e.unfollow=e.unfollow.bind(Object(w.a)(e)),e.closeCommentDialog=e.closeCommentDialog.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,null,[{key:"areElementsTheSame",value:function(e,t){return e.attributeOptionComboId===t.attributeOptionComboId&&e.categoryOptionComboId===t.categoryOptionComboId&&e.periodId===t.periodId&&e.organisationUnitId===t.organisationUnitId&&e.dataElementId===t.dataElementId}}]),Object(S.a)(t,[{key:"unfollow",value:function(){for(var e=[],a=0;a<this.props.elements.length;a++){var n=this.props.elements[a];n.marked&&e.push(t.convertElementToUnFollowupRequest(n))}this.props.unfollow(e)}},{key:"closeCommentDialog",value:function(){this.setState({showComment:!1})}},{key:"updateCheckbox",value:function(e){this.props.toggleCheckbox(e)}},{key:"showComment",value:function(e){e.comment&&this.setState({showComment:!0,comment:e.comment})}},{key:"render",value:function(){var e=this,t=!1,a=[l.a.createElement(Y.e,{label:b.a.t("Close"),primary:!0,onClick:this.closeCommentDialog})],n=this.props.elements.map(function(a){return t=!!a.marked||t,l.a.createElement(Y.o,{key:a.key},l.a.createElement(Y.p,null,a.dataElement),l.a.createElement(Y.p,null,a.organisation),l.a.createElement(Y.p,null,a.period),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:a.min})),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:a.value})),l.a.createElement(Y.p,{className:Se.a.right},l.a.createElement(Ce,{value:a.max})),l.a.createElement(Y.p,{className:Se.a.centerFlex},l.a.createElement("span",{className:Se.a.checkboxWrapper},l.a.createElement(Y.a,{checked:a.marked,onCheck:function(){e.updateCheckbox(a)},iconStyle:ke.iconColor}))),l.a.createElement(Y.p,{className:Se.a.center},a.comment&&l.a.createElement(Y.g,{key:a.key,onClick:function(){e.showComment(a)}},l.a.createElement(Y.f,{className:"material-icons",style:ke.cursorStyle},"speaker_notes"))))});return l.a.createElement("div",null,l.a.createElement(Y.d,{title:b.a.t("Comment"),actions:a,modal:!1,open:this.state.showComment,onRequestClose:this.closeCommentDialog},l.a.createElement("div",{id:"comment-content"},this.state.comment)),l.a.createElement("div",{className:Se.a.cardHeader},l.a.createElement(Ae,{endpoint:Re.endpoints.reportAnalysis})),l.a.createElement(Y.k,{selectable:!1,className:U()(Se.a.appTable,tt.a.followUpAnalysisTable)},l.a.createElement(Y.m,{displaySelectAll:!1,adjustForCheckbox:!1,enableSelectAll:!1},l.a.createElement(Y.o,null,l.a.createElement(Y.n,null,b.a.t("Data Element")),l.a.createElement(Y.n,null,b.a.t("Organisation Unit")),l.a.createElement(Y.n,null,b.a.t("Period")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Min")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Value")),l.a.createElement(Y.n,{className:Se.a.right},b.a.t("Max")),l.a.createElement(Y.n,{className:Se.a.center},b.a.t("Unfollow")),l.a.createElement(Y.n,{className:Se.a.center},b.a.t("Comment")))),l.a.createElement(Y.l,{displayRowCheckbox:!1,stripedRows:!1},n)),l.a.createElement("div",{className:U()(Se.a.cardFooter,Se.a.spaceBetween)},l.a.createElement(Y.i,{id:"unfollow-action",primary:!0,disabled:this.props.loading||!t,label:b.a.t("unfollow"),onClick:this.unfollow}),l.a.createElement(Ae,{endpoint:Re.endpoints.reportAnalysis})))}}]),t}(o.Component);at.contextTypes={d2:I.a.object},at.generateElementKey=function(e){return"".concat(e.attributeOptionComboId,"-").concat(e.categoryOptionComboId,"-").concat(e.periodId,"-").concat(e.sourceId,"-").concat(e.dataElementId)},at.convertElementFromApiResponse=function(e){return{key:at.generateElementKey(e),attributeOptionComboId:e.attributeOptionComboId,categoryOptionComboId:e.categoryOptionComboId,periodId:e.periodId,organisationUnitId:e.sourceId,dataElementId:e.dataElementId,dataElement:e.dataElementName,organisation:e.sourceName,period:e.period.name,min:e.min,max:e.max,value:Number.parseFloat(e.value,10),marked:!e.followup,comment:e.comment}},at.convertElementToUnFollowupRequest=function(e){return{dataElementId:e.dataElementId,periodId:e.periodId,organisationUnitId:e.organisationUnitId,categoryOptionComboId:e.categoryOptionComboId,attributeOptionComboId:e.attributeOptionComboId,followup:!1}};var nt=at,it=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(C.a)(this,Object(D.a)(t).call(this))).state={showTable:!1,startDate:new Date,endDate:new Date,organisationUnitId:null,dataSetIds:[],elements:[],loading:!1},e.getFollowUpList=e.getFollowUpList.bind(Object(w.a)(e)),e.back=e.back.bind(Object(w.a)(e)),e.startDateOnChange=e.startDateOnChange.bind(Object(w.a)(e)),e.endDateOnChange=e.endDateOnChange.bind(Object(w.a)(e)),e.organisationUnitOnChange=e.organisationUnitOnChange.bind(Object(w.a)(e)),e.dataSetsOnChange=e.dataSetsOnChange.bind(Object(w.a)(e)),e.toggleCheckbox=e.toggleCheckbox.bind(Object(w.a)(e)),e.unfollow=e.unfollow.bind(Object(w.a)(e)),e}return Object(x.a)(t,e),Object(S.a)(t,[{key:"componentWillReceiveProps",value:function(e){var a={};Object.keys(e).forEach(function(n){e.hasOwnProperty(n)&&t.STATE_PROPERTIES.includes(n)&&(a[n]=e[n])}),a!=={}&&this.setState(a)}},{key:"getFollowUpList",value:function(){var e=this,t=this.context.d2.Api.getApi();if(this.isFormValid()){this.context.updateAppState({pageState:{loading:!0}});var a={startDate:Ve(this.state.startDate),endDate:Ve(this.state.endDate),ou:this.state.organisationUnitId,ds:this.state.dataSetIds};t.post(Re.endpoints.folloupAnalysis,a).then(function(t){if(e.isPageMounted()){var a=t.map(nt.convertElementFromApiResponse),n=a&&a.length>0?{showSnackbar:!1}:{showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t("No values found")}};e.context.updateAppState(Object(k.a)({},n,{pageState:{loading:!1,elements:a,showTable:a&&a.length>0}}))}}).catch(function(){e.manageError()})}}},{key:"back",value:function(){this.setState({showTable:!1})}},{key:"startDateOnChange",value:function(e,t){this.setState({startDate:new Date(t)})}},{key:"endDateOnChange",value:function(e,t){this.setState({endDate:new Date(t)})}},{key:"organisationUnitOnChange",value:function(e){this.setState({organisationUnitId:e})}},{key:"dataSetsOnChange",value:function(e){for(var t=[],a=e.target.selectedOptions,n=0;n<a.length;n++)t.push(a[n].value);this.setState({dataSetIds:t})}},{key:"toggleCheckbox",value:function(e){for(var t=this.state.elements,a=0;a<t.length;a++){var n=t[a];if(n.key===e.key){n.marked=!n.marked,t[a]=n,this.setState({elements:t});break}}}},{key:"unfollow",value:function(e){var t=this,a=this.context.d2.Api.getApi();this.context.updateAppState({pageState:{loading:!0}}),a.post(Re.endpoints.markDataValue,{followups:e}).then(function(){if(t.isPageMounted()){var a=t.state.elements.filter(function(t){for(var a=0;a<e.length;a++){var n=e[a];if(nt.areElementsTheSame(t,n))return!1}return!0});t.context.updateAppState({showSnackbar:!0,snackbarConf:{type:Z.d,message:b.a.t("Unfollow done")},pageState:{loading:!1,elements:a}})}}).catch(function(){t.manageError()})}},{key:"isFormValid",value:function(){return this.state.startDate&&this.state.endDate&&this.state.organisationUnitId&&this.state.dataSetIds&&this.state.dataSetIds.length>0}},{key:"isActionDisabled",value:function(){return!this.isFormValid()||this.state.loading}},{key:"showAlertBar",value:function(){return this.state.showTable&&this.state.elements&&this.state.elements.length>=Re.results.analysis.limit}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h1",{className:Se.a.pageHeader},l.a.createElement(Y.g,{onClick:this.back,style:{display:this.state.showTable?"inline":"none"}},l.a.createElement(Y.f,{className:"material-icons"},"arrow_back")),l.a.createElement("span",null,b.a.t("Follow-Up Analysis")),l.a.createElement(ye,{sectionDocsKey:ot(this.props.sectionKey)})),l.a.createElement(ne,{show:this.showAlertBar()}),l.a.createElement(K.Card,null,l.a.createElement(K.CardText,{style:{display:this.state.showTable?"none":"block"}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{id:"data-sets-container",className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Data Set")),l.a.createElement(Ke,{onChange:this.dataSetsOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement("div",{className:Se.a.formLabel},b.a.t("Parent organisation unit")),l.a.createElement(fe,{onChange:this.organisationUnitOnChange})),l.a.createElement("div",{className:U()("col-md-4",Se.a.section)},l.a.createElement(X.a,{id:"start-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("Start Date"),onChange:this.startDateOnChange,defaultDate:new Date,maxDate:this.state.endDate,value:this.state.startDate}),l.a.createElement(X.a,{id:"end-date",textFieldStyle:ke.inputForm,floatingLabelText:b.a.t("End Date"),onChange:this.endDateOnChange,defaultDate:new Date,minDate:this.state.startDate,value:this.state.endDate}))),l.a.createElement(q.a,{id:"start-analysis-button",className:Se.a.mainButton,primary:!0,label:b.a.t("follow up"),onClick:this.getFollowUpList,disabled:this.isActionDisabled()})),l.a.createElement(K.CardText,{id:"results-table",style:{display:this.state.showTable?"block":"none"}},l.a.createElement(nt,{elements:this.state.elements,toggleCheckbox:this.toggleCheckbox,unfollow:this.unfollow,loading:this.state.loading}))))}}]),t}(ee);it.STATE_PROPERTIES=["showTable","startDate","endDate","organisationUnitId","dataSetIds","elements","loading"];var st=[{key:"validationRulesAnalysis",path:"/validation-rules-analysis",component:Le,info:{label:function(){return b.a.t("Validation Rule Analysis")},icon:"done_all",description:function(){return b.a.t("Run validation rules in order to unveil anomalies and errors in the data in the database.")},actionText:function(){return b.a.t("Run Validation")},docs:"validation_rule_analysis"}},{key:"stdDevOutlierAnalysis",path:"/std-dev-outlier-analysis",component:Ye,info:{label:function(){return b.a.t("Std Dev Outlier Analysis")},icon:"show_chart",description:function(){return b.a.t("Analyze potential outlier values based on standard deviations. Outlier values can be examined and marked for follow-up.")},actionText:function(){return b.a.t("Analyze")},docs:"standard_deviation_analysis"}},{key:"minMaxOutlierAnalysis",path:"/min-max-outlier-analysis",component:$e,info:{label:function(){return b.a.t("Min-Max Outlier Analysis")},icon:"compare_arrows",description:function(){return b.a.t("Analyze potential outlier values based on min and max values. Outlier values can be examined and marked for follow-up.")},actionText:function(){return b.a.t("Analyze")},docs:"min_max_analysis"}},{key:"followUpAnalysis",path:"/follow-up-analysis",component:it,info:{label:function(){return b.a.t("Follow-Up Analysis")},icon:"description",description:function(){return b.a.t("View or edit data values marked for further follow-up during data entry or analysis.")},actionText:function(){return b.a.t("View Data Values")},docs:"follow_up_analysis"}}],ot=function(e){for(var t=0;t<st.length;t++){var a=st[t];if(a.key===e)return a.info.docs}return""},lt=function(){var e=st.map(function(e){return l.a.createElement("div",{key:e.key,className:U()("col-sm-12 col-md-6 col-lg-4",W.a.gridContainer)},l.a.createElement(B,{key:e.key,section:e}))});return l.a.createElement("div",{id:"grid-list-id",className:"row"},e)},rt=function(e){function t(){return Object(O.a)(this,t),Object(C.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h3",null,"No match for ",l.a.createElement("code",null,this.props.location.pathname)))}}]),t}(o.PureComponent),ct=function(e){var t=e.pageState,a=st.map(function(e){return l.a.createElement(d.a,{key:e.key,exact:!0,path:e.path,render:function(){var a=e.component;return l.a.createElement(a,Object.assign({sectionKey:e.key},t))}})});return a.push(l.a.createElement(d.a,{key:"home",exact:!0,path:"/",render:function(){return l.a.createElement(lt,{sectionKey:"home"})}})),a.push(l.a.createElement(d.a,{key:"no-match-route",component:rt})),l.a.createElement("main",null,l.a.createElement(d.c,null,a))};ct.defaultProps={pageState:{}};var dt=ct,ut=a(219),mt=a.n(ut),pt=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(C.a)(this,Object(D.a)(t).call(this,e))).state={currentSection:"",showSnackbar:!1,snackbarConf:{type:"",message:""},pageState:{}},a.updateAppState=a.updateAppState.bind(Object(w.a)(a)),a}return Object(x.a)(t,e),Object(S.a)(t,[{key:"getChildContext",value:function(){return{d2:this.props.d2,showSnackbar:this.state.showSnackbar,snackbarConf:this.state.snackbarConf,currentSection:this.state.currentSection,updateAppState:this.updateAppState}}},{key:"updateAppState",value:function(e){e.currentSection&&!e.pageState&&this.state.currentSection!==e.currentSection?this.setState(Object(k.a)({},e,{pageState:{},showSnackbar:!1})):this.setState(e)}},{key:"render",value:function(){var e=st.map(function(e){return Object.assign(e,{icon:e.info.icon,label:e.info.label(),containerElement:l.a.createElement(u.b,{to:e.path})})}),t=this.state.pageState.loading?l.a.createElement("div",{className:mt.a.centered},l.a.createElement(j.a,null)):l.a.createElement(_.a,{show:this.state.showSnackbar,conf:this.state.snackbarConf});return l.a.createElement("div",null,l.a.createElement(T.a,{d2:this.props.d2}),l.a.createElement(N.a,{sections:e,currentSection:this.state.currentSection,onChangeSection:function(){return null}}),l.a.createElement("div",{className:mt.a.contentWrapper},l.a.createElement("div",{className:mt.a.contentArea},l.a.createElement(dt,{pageState:this.state.pageState}))),l.a.createElement("div",{id:"feedback-snackbar"},t))}}]),t}(o.PureComponent);pt.childContextTypes={d2:I.a.object,showSnackbar:I.a.bool,snackbarConf:I.a.shape({type:I.a.string,message:I.a.string}),currentSection:I.a.string,updateAppState:I.a.func};var ht=pt,gt=a(113),bt=a.n(gt),ft=a(112),vt=a.n(ft),Et=a(35),yt=a(64),kt={spacing:bt.a,fontFamily:"Roboto, sans-serif",palette:{primary1Color:"#004ba0",primary2Color:Et.blue700,primary3Color:Et.blue100,accent1Color:Et.orange500,accent2Color:Et.grey100,accent3Color:Et.orangeA200,textColor:Et.darkBlack,alternateTextColor:Et.white,canvasColor:Et.white,borderColor:Et.grey400,disabledColor:Object(yt.fade)(Et.darkBlack,.3)}},Ot=vt()(kt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var St=a(714);h.a.setLevel(h.a.levels.INFO);var Ct=Object(d.e)(ht),Dt="".concat("..","/api/").concat("29"),wt=["organisationUnit","dataSet","validationRuleGroup"],xt=function(e){return c.a.render(l.a.createElement(St.MuiThemeProvider,{muiTheme:Ot},l.a.createElement("div",null,l.a.createElement(u.a,null,l.a.createElement(Ct,{d2:e})))),document.getElementById("root"))};(function(){var e=Object(s.a)(i.a.mark(function e(){var t,a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.init)({baseUrl:Dt,schemas:wt});case 2:return t=e.sent,e.next=5,Object(m.getUserSettings)();case 5:a=e.sent,n=a.keyUiLocale,sessionStorage.setItem("uiLocale",n||"en"),y(t),E(a),xt(t);case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},219:function(e,t,a){e.exports={contentArea:"App_contentArea__Y_GhT",contentWrapper:"App_contentWrapper__32IM7",leftBar:"App_leftBar__1mpSD",centered:"App_centered__2lsYq"}},355:function(e,t,a){e.exports={validationTable:"ValidationRulesAnalysisTable_validationTable__IZ4f8",operator:"ValidationRulesAnalysisTable_operator__1yruT"}},356:function(e,t,a){e.exports={select:"AvailableDatasetsSelect_select__2RJaO",options:"AvailableDatasetsSelect_options__2nV_a"}},708:function(e,t,a){e.exports={gridContainer:"Home_gridContainer__2RzmA"}},709:function(e,t,a){e.exports={alertBar:"AlertBar_alertBar__1nykA"}},710:function(e,t,a){e.exports={tree:"AvailableOrganisationUnitsTree_tree__36zmA"}},711:function(e,t,a){e.exports={downloadAs:"DownloadAs_downloadAs__EXpfV"}},712:function(e,t,a){e.exports={outlierAnalysisTable:"OutlierAnalysisTable_outlierAnalysisTable__eaMyR"}},713:function(e,t,a){e.exports={followUpAnalysisTable:"FollowUpAnalysisTable_followUpAnalysisTable__plQH2"}},720:function(e,t,a){e.exports=a(1552)},757:function(e,t,a){},81:function(e,t,a){e.exports={sectionBox:"ValidationRulesDetails_sectionBox__3I79x",sectionTitle:"ValidationRulesDetails_sectionTitle__j-YIb",sectionSubTitle:"ValidationRulesDetails_sectionSubTitle__3oXtg",noData:"ValidationRulesDetails_noData__csWGG"}}},[[720,1,2]]]);
//# sourceMappingURL=main.4e486ca3.chunk.js.map